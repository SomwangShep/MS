<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="MsVideo/MSVideo.css" />

    <title>MS Video</title>

    <!-- Bootstrap -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">

    <style>
	</style>

	</head>
	<body>
		<!-- page content -->
		<div class="container">
			<div class="jumbotron">
				<form id="loginForm" >
					<h2 class="text-center">Welcome to the MS Balance Study:
					<br>Tai Chi & Mindfulness Meditation Home Practice Website!</h2>
					
					<p>Through this website you will be able to access your Tai Chi 
					Videos or Mindfulness Meditation Podcasts 
					(depending on your intervention), 
					and will monitor your progress towards achieving your 
					homework practice time goal!</p>
					
					<p>To get started, begin by entering your ID below then click the 
					‘Login’ button. If you do not have an ID, or need assistance 
					with accessing content of this website please contact the 
					person who provided this URL.</p>
	
					<div class="form-group">
						
						<input type="text" class="form-control"
							id="userID" name="userID" placeholder="user id">
					</div>
					<button id="addBtn" type="button" class="btn btn-lg btn-success">Login</button>
				</form>
				<p id="message"</p>

			</div>
		</div>
			
		<!-- jquery and bootstrap -->
		<script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

		<!-- custom local javascript -->
		<script>
		    // model
        	var model = [];
        	var model2 = [];
			
			// view 
			function updateView()
			{
				if (model.error != undefined)
				{
					console.log("update view error");
					$("#message").text(model.error);
				}
				else if(model.notFound != undefined)
				{
					console.log("update view notFound");
					$("#message").text("Access Denined");					
				}				
				else
				{
					//doing something
					console.log(model.length);
					console.log("update view else, else");
					var row = model[0];
					$("#message").html("Hello " + row.fname + ": "  + 
					"<a href = MsVideo/Source.html> Please click here to go to the next page");
				}
			}

			// controller
			$(document).ready(function ()
			{
				
			});

			$("#addBtn").click(function ()
			{
				sendCommand("login");
            });
            
            function sendCommand(cmd)
            {
            	console.log("sendCommand");
		    	var url = "MsVideo/MSVideo.php?cmd="+cmd;
	            var data = $("#loginForm" ).serialize();
                var request = $.post(url, data);
                request.done(function(json)
                {
                	console.log(json);
                    model = json;
                    updateView();
                });
                request.fail(function(jqXHR, textStatus, errorThrown)
                {
                    $("#message").text("Error: "+ textStatus);
                    console.log("fail object ", jqXHR);
                    console.log("error thrown ", errorThrown);
                    updateView();
                });
            }
		</script>
	</body>
</html>
